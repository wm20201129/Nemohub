# 班级积分管理系统 (Class Points Manager - Lite) 使用手册

这是一个为您精心准备的轻量化、免安装班级积分管理工具。本手册旨在帮助您快速上手，利用积分激励机制提升班级管理效率。

---

## 🚀 V3 版本新特性

*   **🌐 内网穿透集成**：支持在后台直接开启隧道，生成的公网链接可分享给家长，实现跨网络查看。
*   **🧑‍🎓 学生自管模式**：支持班干部（如卫生、纪律委员）自主申报积分申请。
*   **⚖️ 班主任审核流**：新增审核中心，老师一键审批学生申报，积分生效更严谨。
*   **📊 家校管理优化**：支持学生个人档案卡、老师寄语及一键导出班级周报 Excel。
*   **📈 积分管理优化**：增强了批量加减分逻辑，支持历史溯源及可视化积分趋势图表。

---

## 🌐 内网穿透 (在线访问) 详细指南

如果您希望家长在校外（使用手机流量或家里 Wi-Fi）也能查看积分榜，请按照以下步骤配置：

### 1. 申请 Ngrok Token (仅需一次)
1.  访问 **[ngrok.com](https://ngrok.com/)** 官网。
2.  点击 **Sign Up** 注册账号（支持 Google 账号一键登录）。
3.  登录后，在左侧菜单栏点击 **"Your Authtoken"**。
4.  复制显示的这一串代码（这是您的唯一身份标识）。

### 2. 在软件中开启在线访问
1.  在系统主页面，点击右上角的 **“在线访问”** 或 **“内网穿透”** 图标。
2.  在弹出的对话框中，将刚才复制的 **Token** 粘贴进去并点击 **“启动隧道”**。
3.  **扫码分享**：系统会自动生成一个专属 **二维码**。
4.  **展示与传播**：您只需用手机扫描该二维码，或者将二维码截图发到家长群，家长扫码即可实时查看班级积分动态。

> **注意**：
> *   免费版 Ngrok 每次重启程序后链接可能会变。
> *   建议在需要公示时开启，平时关闭以节省资源。

## 🆙 版本升级指南 (重要)

---

如果您之前使用的是旧版本，请按照以下步骤平滑升级到 V3，确保数据不丢失：

1.  **备份旧数据**：进入您的旧版软件文件夹，找到 **`data`** 文件夹和 **`static/uploads`** 文件夹（这里存放着您的奖品照片），将其复制并备份。
2.  **部署新版**：解压新版 V3 压缩包到您喜欢的位置。
3.  **数据迁移**：
    *   将备份的 **`data`** 文件夹覆盖到新版根目录。
    *   将备份的 **`uploads`** 文件夹（或其内容）覆盖到新版的 **`static/uploads`** 目录中，确保奖品照片正常显示。
    *   如果您修改过 **`password.txt`**，也请将其一并覆盖到新版。
4.  **启动与自动适配**：双击运行新版 `ClassPointsManager.exe`。
    *   系统会自动检测旧版数据库并完成结构升级（如：自动增加审核、评价等新字段）。
    *   **无需任何手动数据库操作**，直接开始使用新功能即可。

### ---------------------------------------v1、v2 ------------------------------------ ###

## 🌟 核心特性：离线便携，即插即用

本系统专为教师办公场景设计，具有以下极致的便携性：

1.  **完全离线运行**：系统运行**不需要连接互联网**。无论是在没有 Wi-Fi 的教室，还是网络不稳的操场，只要电脑有电就能正常使用。
2.  **U盘/移动硬盘随插随用**：您可以将整个项目文件夹拷贝到 U盘或移动硬盘中。
    *   在办公室电脑录入数据，回家插上 U盘就能直接继续操作。
    *   **无需重新安装**，**无需配置环境**，数据跟随 U盘走。
3.  **数据永不丢失**：所有积分、学生信息、奖品图片都保存在您手里的文件夹内，不依赖任何云端服务器，只要您不删除 `data` 文件夹，数据永远安全。

---

### 系统架构
本系统采用 **本地服务器 + 浏览器访问** 的模式：
*   **后端**: 由内置的 Python 程序处理所有逻辑。
*   **数据库**: 使用轻量级 SQLite，所有数据均保存在本地文件夹中，不上传云端，确保隐私安全。
*   **前端**: 响应式网页设计，支持电脑、手机和平板流畅操作。

### ⚠️ 重要提示：不可动的文件
为了保证系统正常运行，请勿删除或移动以下内容：
1.  **`data/` 文件夹**：存放所有积分数据。**弄丢它 = 数据清空**。
2.  **`_internal/` 文件夹**：存放系统运行必须的组件，请勿修改。
3.  **`static/uploads/`**：存放您上传的奖品图片，删除会导致图片无法显示。

---

## 🚀 快速启动

1.  **启动程序**：双击运行 `ClassPointsManager_Lite.exe`。
2.  **保持运行**：运行时会弹出一个黑色窗口（控制台），**使用期间请勿关闭它**。
3.  **进入系统**：打开电脑上的浏览器（推荐 Chrome 或 Edge），在地址栏输入：
    `http://localhost:5001`
    按下回车即可进入管理后台。

---

## 📖 详细操作指南

### 第一步：班级与学生初始化
在使用积分功能前，您需要先建立学生名单。
1.  **进入管理**：点击导航栏的 **“班级管理”** 或 **“学生管理”**。
2.  **批量导入 (推荐)**：
    *   点击 **“导入学生”** 按钮。
    *   您可以下载系统提供的 Excel 模板。
    *   在 Excel 中填入学生姓名、性别、所属小组。
    *   上传 Excel，系统会自动为您创建学生账号并分配小组。
3.  **手动添加**：也可以点击 “添加学生” 单独录入。

### 第二步：积分操作 (核心功能)
1.  **个人加减分**：
    *   在主页或学生列表找到特定学生，点击 **“加/减分”**。
    *   选择或输入分值，并填写理由（如：主动清扫、回答问题出色）。
2.  **批量加减分 (最高效)**：
    *   在积分操作页面，勾选多个学生，或者点击 **“全选”**。
    *   也可以点击 **“按小组选择”**。
    *   设置统一的积分变动数值和理由，一键完成。

### 第三步：小组管理
1.  **设置小组**：进入 **“分组管理”**，可以为不同小组设置不同的代表颜色。
2.  **平均分统计**：系统会自动计算小组内所有成员的平均分，用于公平地展示小组竞争力。

### 第四步：奖品墙与兑换
1.  **添加奖品**：进入 **“奖品管理”**，上传奖品照片，设置所需的积分和库存数量。
2.  **兑换操作**：
    *   当学生积分达到标准时，点击 **“兑换”**。
    *   **小组兑换**：如果设置了小组奖品，积分将从该组每个成员的积分中平均扣除。

### 第五步：查看排行榜
*   点击 **“排行榜”** 即可查看学生排名和小组排名。
*   支持切换 **“本周”、“本月” 或 “总榜”**，方便进行周冠军或月度之星的评选。

---

## 📱 手机/平板同步使用 (局域网)

如果您想在教室里拿着手机走动评分，只需确保手机和电脑连接在**同一个 Wi-Fi** 下：
1.  **获取 IP**：在运行程序的黑色窗口中，找到类似 `Running on http://192.168.x.x:5001` 的地址。
2.  **手机访问**：在手机浏览器输入这个 `192.168.x.x:5001`。
3.  **小技巧**：在手机浏览器中选择 **“添加到主屏幕”**，以后可以像点击 App 一样直接打开。

---

## 🌐 进阶：内网穿透 (让学生在家也能看)

如果您希望在校外（非局域网）访问，请按以下步骤配置 **Ngrok**：

1.  **注册账号**：去 [ngrok.com](https://ngrok.com/) 注册并获取你的 **Authtoken**。
2.  **配置**：下载 ngrok 客户端，在命令行运行：
    `.\ngrok config add-authtoken 你的Token`
3.  **启动映射**：在开启积分系统的情况下，运行：
    `.\ngrok http 5001`
4.  **分享链接**：将 ngrok 界面显示的 `https://xxxx.ngrok-free.app` 链接发给家长或学生。
    *注：免费版每次重启 ngrok 链接会变，建议保持电脑不关闭。*

---
*Created by Author_Nemo | 您的班级管理好帮手*